// Modefied from
// Puertas II
// por Celeste Betancur
// https://github.com/essteban

osc(13,0,1)
    .kaleid(4)
    .mask(shape(4,0.3,1))
    .modulateRotate(shape(4,0.1,1))
    .modulateRotate(shape(4,0.1,0.9))
    .modulateRotate(shape(4,0.1,0.8))
	// .modulateScale(osc(100, 1).thresh(0.9))
	.mult(gradient(2).colorama(10).brightness(-1.5))
    .scale([0.3, 0.5, 0.7, 1, 0.7, 0.3].smooth())
    .add(shape(4,0.2,1).color(1,1,1,0.4))
	.colorama([0.5, 1, 2].smooth())
	.luma([0.6,0.2,0,0.3].smooth())
	// .thresh([0.8, 0.9, 0.6].smooth())
	// .colorama(2)
	// .color(1,0.3,4)
	// .colorama([15, 15, 15, 0, 0, 0].fast())
	.brightness(-0.2)
    .rotate(()=>time)
    .out(o0)

hush()

osc(2,1,0.6)
.brightness(-0.7)
.rotate(() => time / 4)
.pixelate(100,10)
.layer(osc(2,1,0.4).luma(0.8).brightness(-0.4))
.modulate(o0)
.colorama(0.4)
.brightness(-0.6)
.contrast(1.2)
.out(o0)

osc()
	.modulateScale(gradient(10))
	.modulate(src(o0).mult(osc(10)))
	.modulate(osc(2).repeatX(10).modulateRepeatX(osc(10)))
	.colorama(0.35)
	.color(2,0.4,0.4)
	.rotate(() => time / 10)
	.luma(0.35)
	.modulateRepeatX(osc(2))
	.modulate(shape(4,0.2,2.5))
	.modulate(shape(4,0.5,1.5).rotate(2).scrollX(0.5))
	.modulate(shape(4,0.5,1.5).rotate(5).scrollX(0.8))
	.luma(0.4)
	.mult(noise(5,0.1).pixelate(100, [2,3,3,4,5].smooth()))
	.modulate(o0)
	.out(o0)

  bpm = 100
speed = 2

osc(10, 0.1)
	.colorama(10)
	.add(gradient(2).brightness(-0.75).thresh(0.2))
	.color(1,0.6,1)
	.modulateRotate(shape(4, 0.1))
	.modulateRotate(shape(4, 0.5).repeat([10, 20, 30].smooth()))
	.modulateRotate(shape(4, 0.1))
//	.modulateScale(osc([1,2,3].smooth()))
	.colorama(0.1)
	.luma(0.45)
	.modulate(o0, 0.1)
	//.blend(shape(4).scale(10).color(1.5,0.1,0.1).luma([0.15,0.5,0.5,0.15].smooth()).brightness(-0.2).luma(0.21))
	.out(o0)
